version: 2

macros:
  - name: get_min_date
    description: >
      Queries the target model to determine the earliest date present across
      *all* columns identified as the 'DATE' data type. It uses the 
      `get_date_columns` macro internally to find the relevant columns.
      Returns the result as a 'YYYY-MM-DD' string.
    arguments:
      - name: model
        type: model or source reference
        description: |
          The dbt model or source object (e.g., {{ '{' }}{{ '{' }} ref('my_model') {{ '}' }}{{ '}' }}) to be analyzed.
          The macro introspects this object to find all its date columns.