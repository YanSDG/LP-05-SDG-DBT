models:
- name: int_order_items
  description: This model integrates line items with their corresponding orders, providing
    a comprehensive view of order details and line item specifics. It is useful for
    analyzing order composition, fulfillment timelines, and customer interactions.
  config:
    tags: ['sales']
  data_tests:
    - dbt_utils.unique_combination_of_columns:
        arguments:
          combination_of_columns:
            - order_id
            - line_number
  columns:
  - name: order_id
    description: "{{ doc('orders_id_description') }}"
    data_tests:
      - not_null
  - name: part_id
    description: "{{ doc('orders_id_description') }}"
    data_tests:
      - not_null
  - name: supplier_id
    description: "{{ doc('suppliers_id_description') }}"
    data_tests:
      - not_null
  - name: line_number
    description: "{{ doc('line_number_description') }}"
    data_tests:
      - not_null
      - is_integer
      - is_positive
  - name: quantity
    description: "{{ doc('lineitems_quantity_description') }}"
    data_tests:
      - not_null
      - is_integer
      - is_positive
  - name: extended_price
    description: "{{ doc('lineitems_extended_price_description') }}"
    data_tests:
      - not_null
      - is_positive
  - name: discount
    description: "{{ doc('lineitems_discount_description') }}"
    data_tests:
      - not_null
      - value_between:
          arguments:
            min_value: 0
            max_value: 1
  - name: tax
    description: "{{ doc('lineitems_tax_description') }}"
    data_tests:
      - not_null
      - value_between:
          arguments:
            min_value: 0
            max_value: 1
  - name: return_flag
    description: "{{ doc('lineitems_return_flag_description') }}"
  - name: line_status
    description: "{{ doc('lineitems_line_status_description') }}"
    data_tests:
      - accepted_values:
          arguments:
            values:
              - O
              - F
  - name: ship_date
    description: "{{ doc('lineitems_ship_date_description') }}"
  - name: commit_date
    description: "{{ doc('lineitems_commit_date_description') }}"
  - name: receipt_date
    description: "{{ doc('lineitems_receipt_date_description') }}"
  - name: ship_instruction
    description: "{{ doc('lineitems_ship_instruction_description') }}"
  - name: ship_mode
    description: "{{ doc('lineitems_ship_mode_description') }}"
  - name: customer_id
    description: "{{ doc('customers_id_description') }}"
    data_tests:
      - not_null
  - name: order_status
    description: "{{ doc('orders_status_description') }}"
    data_tests:
      - accepted_values:
          arguments:
            values:
              - O
              - F
              - P
  - name: total_price
    description: "{{ doc('orders_total_price_description') }}"
    data_tests:
      - not_null
      - is_positive
  - name: order_date
    description: "{{ doc('orders_date_description') }}"
  - name: order_priority
    description: "{{ doc('orders_priority_description') }}"
  - name: clerk
    description: "{{ doc('orders_clerk_description') }}"
  - name: ship_priority
    description: "{{ doc('orders_ship_priority_description') }}"
