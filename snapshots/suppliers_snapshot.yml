version: 2

snapshots:
  - name: suppliers_snapshot
    description: >
      Tracks the historical changes (Type 2 Slowly Changing Dimension) for supplier 
      attributes. This is primarily used to analyze the supplier's financial 
      history, especially the account balance, for procurement and risk analysis.
    columns:
      - name: s_suppkey
        description: The **Unique Key** (Supplier ID) used to identify the supplier across all historical versions.
      - name: s_name
        description: The name of the supplier. Changes to this column trigger a new snapshot record.
      - name: s_nationkey
        description: Foreign key identifying the supplier's nation. Changes to this column trigger a new snapshot record.
      - name: s_acctbal
        description: >
          The supplier's current account balance. **This is a key tracked column**; 
          any change to this financial value will create a new historical record.
      
      # dbt-added metadata columns
      - name: dbt_scd_id
        description: A unique surrogate key generated by dbt for each historical version of the supplier record.
      - name: dbt_updated_at
        description: Timestamp when the source record was last observed to have changed.
      - name: dbt_valid_from
        description: Timestamp indicating when this supplier version became active.
      - name: dbt_valid_to
        description: >
          Timestamp indicating when this supplier version became invalid because a new version was recorded. 
          A NULL value means this is the currently active version.